# ===========================
# Plugin Manager (TPM)
# ===========================
# List of plugins
set -g @plugin 'tmux-plugins/tpm'

set -g @plugin 'tmux-plugins/tmux-sidebar'
set -g @sidebar-width 100
set -g @sidebar-tree-command 'tree -L 2 -C --dirsfirst --noreport'
set -g @sidebar-tree-pager 'less -R -S -M'

run '~/.tmux/plugins/tpm/tpm'

# ===========================
# Colors
# ===========================
bg0="#282828"
bg1="#3c3836"
bg2="#504945"
bg3="#665c54"
fg0="#fbf1c7"
fg1="#ebdbb2"
fg2="#d5c4a1"
fg3="#bdae93"
red="#cc241d"
green="#98971a"
yellow="#d79921"
blue="#458588"
purple="#b16286"
aqua="#689d6a"
orange="#d65d0e"
gray="#928374"

# ===========================
# Server Options
# ===========================
set -sg default-terminal "tmux-256color"
set -sg escape-time 0
set -sg focus-events on
set -asg terminal-overrides ",*:Tc"

# ===========================
# Session Options
# ===========================
set -g base-index 1
set -g mouse on
set -g renumber-windows on
set -g repeat-time 600
set -g history-limit 10000

set -g display-panes-active-colour "$yellow"
set -g display-panes-colour "$bg2"

set -g status on
set -g status-bg "$bg1"
set -g status-fg "$fg1"
set -g status-interval 15
set -g status-justify left
set -g status-position top
set -g status-right-length 100
set -g status-style "bg=$bg1,fg=$fg1"
set -g status-left "#[bg=$yellow,fg=$bg0,bold] #S:#P #[bg=$bg1,fg=$fg1] "
set -g status-right "#(\
    if [ \"\$(tmux display-message -p '#{pane_in_mode}')\" = 1 ]; then \
        echo '#[bg=$blue,fg=$bg0] COPY '; \
    elif [ \"\$(tmux display-message -p '#{client_prefix}')\" = 1 ]; then \
        echo '#[bg=$purple,fg=$bg0] PREFIX '; \
    elif [ \"\$(tmux display-message -p '#{window_zoomed_flag}')\" = 1 ]; then \
        echo '#[bg=$orange,fg=$bg0] ZOOM '; \
    elif [ \"\$(tmux display-message -p '#{?pane_synchronized,1,0}')\" = 1 ]; then \
        echo '#[bg=$red,fg=$fg2] SYNC '; \
    else \
        echo '#[bg=$green,fg=$bg0] NORMAL '; \
    fi \
)#[bg=$bg1,fg=$fg1] %Y-%m-%d %H:%M #[bold]#(whoami)@#(hostname -f)#[nobold] "
set -g status-keys vi

set -g activity-action none
set -g silence-action none

set -g visual-activity off
set -g visual-bell off
set -g visual-silence off

# ===========================
# Window & Pane Options
# ===========================
setw -g cursor-style blinking-bar

setw -g clock-mode-colour "$blue"
setw -g clock-mode-style 24

setw -g mode-keys vi
setw -g mode-style "bg=$bg2,fg=$fg1"

setw -g monitor-activity on
setw -g monitor-bell on
setw -g monitor-silence 30

setw -g pane-active-border-style "fg=$yellow"
setw -g pane-base-index 1
setw -g pane-border-style "fg=$bg2"

setw -g window-status-style "bg=$bg1,fg=$fg3"
setw -g window-status-current-style "bg=$bg0,fg=$orange,bold"
setw -g window-status-activity-style "bg=$bg1,fg=$aqua"
setw -g window-status-format " #I:#W#F "
setw -g window-status-current-format " #I:#W#F "
setw -g window-status-separator ""

# ===========================
# Key Bindings
# ===========================
# Reload config file
bind r source-file ~/.tmux.conf \; display-message "Config reloaded"

# Split panes using | and -
bind-key -T prefix \\ split-window -h -c "#{pane_current_path}"
bind | split-window -h -b -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind _ split-window -v -b -c "#{pane_current_path}"
unbind '"'
unbind %

# Switch panes using Alt + h/j/k/l without prefix
bind -n M-h select-pane -L
bind -n M-l select-pane -R
bind -n M-k select-pane -U
bind -n M-j select-pane -D

# Resize panes using Prefix + H/J/K/L
bind -r H resize-pane -L 5
bind -r L resize-pane -R 5
bind -r K resize-pane -U 5
bind -r J resize-pane -D 5

# Quick window switching (Alt + number)
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9

# Copy mode vi bindings (for better Neovim consistency)
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send -X copy-pipe-and-cancel "xclip -in -selection clipboard"
